###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.60.1.5097/W32 for ARM      09/Oct/2014  10:33:31 #
# Copyright 1999-2013 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  C:\Users\FredZhou\Documents\Origin\Projects\platform\STM #
#                    32L1XX\Libraries\SDK_Eval_STM32L\src\SDK_EVAL_Config.c   #
#    Command line =  C:\Users\FredZhou\Documents\Origin\Projects\platform\STM #
#                    32L1XX\Libraries\SDK_Eval_STM32L\src\SDK_EVAL_Config.c   #
#                    -D USE_STDPERIPH_DRIVER -D STM32L1XX_MD -D               #
#                    SYSCLK_FREQ_HSI_32MHz -D ENABLE_USB -D                   #
#                    ENABLE_USB_PRINTF -D CLIENT=1 -D DEBUG -D                #
#                    BLUENRG_CONFIG=BLUENRG_16_MHZ -lcN                       #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\Client\List\ --diag_suppress Pa050 -o         #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\Client\Obj\ --debug --endian=little           #
#                    --cpu=Cortex-M3 -e --fpu=None --dlib_config "C:\Program  #
#                    Files (x86)\IAR Systems\Embedded Workbench               #
#                    6.5\arm\INC\c\DLib_Config_Normal.h" -I                   #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\..\inc\ -I "C:\Users\FredZhou\Documents\Origi #
#                    n\Projects\Project\BLE_Chat\EWARM\..\..\..\Bluetooth     #
#                    LE\SimpleBlueNRG_HCI\" -I "C:\Users\FredZhou\Documents\O #
#                    rigin\Projects\Project\BLE_Chat\EWARM\..\..\..\Bluetooth #
#                     LE\SimpleBlueNRG_HCI\includes\" -I                      #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\..\..\..\platform\STM32L1XX\ -I               #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\..\..\..\platform\STM32L1XX\Libraries\ -I     #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\..\..\..\platform\STM32L1XX\Libraries\CMSIS\C #
#                    M3\DeviceSupport\ST\STM32L1xx\ -I                        #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\..\..\..\platform\STM32L1XX\Libraries\STM32_U #
#                    SB-FS-Device_Driver\inc\ -I                              #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\..\..\..\platform\STM32L1XX\Libraries\STM32L1 #
#                    xx_StdPeriph_Driver\inc\ -I                              #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\..\..\..\platform\STM32L1XX\Libraries\I2C\inc #
#                    \ -I C:\Users\FredZhou\Documents\Origin\Projects\Project #
#                    \BLE_Chat\EWARM\..\..\..\platform\STM32L1XX\Libraries\LI #
#                    S3DH\inc\ -I C:\Users\FredZhou\Documents\Origin\Projects #
#                    \Project\BLE_Chat\EWARM\..\..\..\platform\STM32L1XX\Libr #
#                    aries\STLM75\inc\ -I C:\Users\FredZhou\Documents\Origin\ #
#                    Projects\Project\BLE_Chat\EWARM\..\..\..\platform\STM32L #
#                    1XX\Libraries\HTS221\inc\ -I                             #
#                    C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\..\..\..\platform\STM32L1XX\Libraries\LPS25H\ #
#                    inc\ -I C:\Users\FredZhou\Documents\Origin\Projects\Proj #
#                    ect\BLE_Chat\EWARM\..\..\..\platform\STM32L1XX\Libraries #
#                    \SDK_Eval_STM32L\inc\ -Ohs --use_c++_inline -I           #
#                    "C:\Program Files (x86)\IAR Systems\Embedded Workbench   #
#                    6.5\arm\CMSIS\Include\"                                  #
#    List file    =  C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\Client\List\SDK_EVAL_Config.lst               #
#    Object file  =  C:\Users\FredZhou\Documents\Origin\Projects\Project\BLE_ #
#                    Chat\EWARM\Client\Obj\SDK_EVAL_Config.o                  #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\FredZhou\Documents\Origin\Projects\platform\STM32L1XX\Libraries\SDK_Eval_STM32L\src\SDK_EVAL_Config.c
      1          /**
      2           * @file    SDK_EVAL_Config.c
      3           * @author  AMS - AAS Division
      4           * @version V1.0.1
      5           * @date    March 10, 2014
      6           * @brief   This file provides all the low level API to manage SDK Version identification.
      7           * @details
      8           *
      9           * THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS
     10           * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE
     11           * TIME. AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY
     12           * DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING
     13           * FROM THE CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE
     14           * CODING INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.
     15           *
     16           * THIS SOURCE CODE IS PROTECTED BY A LICENSE.
     17           * FOR MORE INFORMATION PLEASE CAREFULLY READ THE LICENSE AGREEMENT FILE LOCATED
     18           * IN THE ROOT DIRECTORY OF THIS FIRMWARE PACKAGE.
     19           *
     20           * <h2><center>&copy; COPYRIGHT 2014 STMicroelectronics</center></h2>
     21           */
     22          
     23          
     24          /* Includes ------------------------------------------------------------------*/
     25          #include "stm32l1xx.h"
     26          #include "SDK_EVAL_Config.h"
     27          
     28          /** @addtogroup SDK_EVAL_STM32L
     29           * @{
     30           */
     31          
     32          
     33          /** @addtogroup SDK_EVAL_Config
     34           * @{
     35           */
     36          
     37          /** @defgroup SDK_EVAL_Config_Private_TypesDefinitions             SDK EVAL Config Private Types Definitions
     38           * @{
     39           */
     40          
     41          /**
     42           * @}
     43           */
     44          
     45          
     46          /** @defgroup SDK_EVAL_Config_Private_Defines                      SDK EVAL Config Private Defines
     47           * @{
     48           */
     49          
     50          /**
     51           * @}
     52           */
     53          
     54          
     55          /** @defgroup SDK_EVAL_Config_Private_Macros                       SDK EVAL Config Private Macros
     56           * @{
     57           */
     58          
     59          /**
     60           * @}
     61           */
     62          
     63          
     64          /** @defgroup SDK_EVAL_Config_Private_Variables                    SDK EVAL Config Private Variables
     65           * @{
     66           */
     67          /**
     68           * @}
     69           */
     70          
     71          
     72          /**
     73           * @defgroup SDK_EVAL_Config_Private_FunctionPrototypes                    SDK EVAL Config Private Function Prototypes
     74           * @{
     75           */
     76          
     77          /**
     78           * @}
     79           */
     80          
     81          
     82          /**
     83           * @defgroup SDK_EVAL_Config_Private_Functions                             SDK EVAL Config Private Functions
     84           * @{
     85           */
     86             
     87          #ifdef USER_DEFINED_PLATFORM    
     88          static uint8_t s_SdkEvalVersion = USER_PLATFORM_VERSION; 
     89          #else
     90          static uint8_t s_SdkEvalVersion = SDK_EVAL_VERSION_3;
     91          #endif
     92          
     93          /**
     94           * @brief  Identify the version of the current BlueNRG platform.
     95           * @param  None.
     96           * @retval None.
     97           */
     98          void SdkEvalIdentification(void)
     99          {
    100          #ifdef USER_DEFINED_PLATFORM 
    101          
    102            /* User defined platform: SPI configuration is on file USER_Platform_Configuration.h
    103               (to be customized for matching user defined platform */
    104            s_SdkEvalVersion = USER_PLATFORM_VERSION; 
    105          
    106          #else
    107            /* Identify BlueNRG Development Kit at run-time using GPIO logic */
    108            GPIO_InitTypeDef GPIO_InitStructure; 
    109            
    110            /* Enables the MCU GPIO Clock */
    111            RCC_AHBPeriphClockCmd(RCC_AHBPeriph_GPIOD, ENABLE);  
    112            
    113            GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
    114            GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;
    115            GPIO_InitStructure.GPIO_Speed = GPIO_Speed_40MHz;
    116            GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
    117            GPIO_InitStructure.GPIO_Pin = GPIO_Pin_2;
    118            GPIO_Init(GPIOD, &GPIO_InitStructure);
    119              
    120            GPIOD->ODR |= GPIO_Pin_2;
    121              
    122            for(volatile uint8_t i=0;i<1;i++);
    123              
    124            if((GPIOD->IDR) & GPIO_Pin_2) 
    125            {
    126               s_SdkEvalVersion = SDK_EVAL_VERSION_3;
    127            }
    128            else
    129            {
    130               s_SdkEvalVersion = SDK_EVAL_VERSION_D1;
    131            }
    132              
    133            GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN;
    134            GPIO_Init(GPIOD, &GPIO_InitStructure);
    135              
    136            GPIOD->ODR &= ~GPIO_Pin_2;
    137          
    138          #endif /* USER_DEFINED_PLATFORM */
    139            
    140          }/* end SdkEvalIdentification() */
    141          
    142          /**
    143           * @brief  Returns the version of the current BlueNRG platform.
    144           * @param  None.
    145           * @retval None.
    146           */
    147          uint8_t SdkEvalGetVersion(void)
    148          {
    149           return s_SdkEvalVersion;
    150          }/* end SdkEvalGetVersion() */
    151          
    152          /**
    153           * @}
    154           */
    155          
    156          /**
    157           * @}
    158           */
    159          
    160          /**
    161           * @}
    162           */
    163          
    164          
    165          
    166          /******************* (C) COPYRIGHT 2014 STMicroelectronics *****END OF FILE****/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       0   SdkEvalGetVersion
      24   SdkEvalIdentification
        24   -> GPIO_Init
        24   -> RCC_AHBPeriphClockCmd


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable1
       4  ??DataTable1_1
       6  SdkEvalGetVersion
     186  SdkEvalIdentification
       1  s_SdkEvalVersion

 
   1 byte  in section .bss
 200 bytes in section .text
 
 200 bytes of CODE memory
   1 byte  of DATA memory

Errors: none
Warnings: none
